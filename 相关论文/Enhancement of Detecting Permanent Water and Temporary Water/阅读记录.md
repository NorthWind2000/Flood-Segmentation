题目：Enhancement of Detecting Permanent Water and Temporary Water in Flood Disasters by Fusing Sentinel-1 and Sentinel-2 Imagery Using Deep Learning Algorithms: Demonstration of Sen1Floods11 Benchmark Datasets

# Abstract

有效识别洪水灾害中的永久水和临时水主要依赖于多时相遥感图像的变化检测方法，但仅从洪水后遥感图像估计洪水灾害事件中的水类型仍然具有挑战性。近年来的研究进展表明，多源数据融合和深度学习算法在改进洪水探测方面具有巨大潜力，但由于缺乏大规模洪水事件的标记遥感图像，这一领域的研究才刚刚起步。在此，我们介绍了新的深度学习算法和多源数据融合驱动的洪水淹没测绘方法，该方法利用了大规模公开的Sen1Flood11数据集，该数据集由近几年从全球洪水事件中收集的约4831个标记的Sentinel-1  SAR和Sentinel-2光学图像组成。具体来说，我们提出了一种地表水、永久水和临时水识别的自动分割方法，所有任务共享相同的卷积神经网络结构。我们利用焦点损失来处理类（水/非水）不平衡问题。彻底的烧蚀实验和分析证实了各种设计方案的有效性。

# 一、Introduction

​		近年来，研究人员在基于卫星遥感图像的洪水探测方面做了大量工作。区分水域和非水域最常用的方法是基于阈值分割的方法[12–15]。然而，最佳阈值受图像采集的地理区域、时间和大气条件的影响。因此，上述方法的泛化能力非常有限。**近年来，欧洲航天局（欧空局）开发了一系列哨兵任务，以提供免费可用的数据集，包括来自哨兵-1传感器的合成孔径雷达（SAR）数据和来自哨兵-2传感器的光学数据，同时考虑到光学图像和SAR图像在洪水信息提取方面各自的优势[5,14,16–18]，研究人员对将SAR图像与光学图像相结合以进行更精确的洪水测绘的研究非常感兴趣**。尽管数据融合方法提高了洪水提取的准确性，但在洪水灾害中区分永久性水和临时性水问题仍然是一个非常具有挑战性的问题。**洪水灾害中临时水域和永久水域的识别主要依赖于多时相变化检测方法**。虽然基于多时相变化检测的方法能够更好地检测洪水灾害事件中的临时水，但由于灾害前对卫星图像的强制性要求，多时相方法受到了很大的限制。

​		以卷积神经网络为代表的深度学习方法已被证明在洪灾损失评估领域是有效的，相关研究自2017年以来发展迅速[29]。然而，大多数算法都关注洪水事件中受影响的建筑物[22,30]，很少有洪水检测的例子。最新的研究集中在应用深度学习算法来增强洪水检测。**早期的研究集中于地表水的提取[33–35]。Furkan等人提出了一种基于深度学习的方法，用于从陆地卫星图像绘制地表水地图。结果表明，深度学习方法优于传统的阈值和多层感知器模型。**

​		为了开发一种基于Sen1Flood数据集的有效基准算法，用于区分洪水灾害中的永久水和临时水，以推动该领域的研究，本研究的贡献和独创性如下：

1. 有效性：据我们所知，就sen1flood11数据集而言，我们提出的算法的精度是迄今为止最高的。
2. 便利性：模型中使用的所有sentinel-1和sentinel-2图像均来自洪水后图像，这大大减少了洪水前对卫星图像数据的依赖。
3. 细化：引入显著目标检测算法对卷积神经网络分类器进行了改进，并采用多尺度损失算法和数据扩充方法提高了模型的精度。
4. 鲁棒性：在一个新的玻利维亚洪水数据集上验证了我们提出的算法的鲁棒性。

# 二、Sen1Floods11 Dataset

​		对于每个选定的洪水事件，获取Sentinel-1图像和Sentinel-2图像之间的时间间隔不得超过两天。Sentinel-1图像包含两个波段，VV和VH，它们是后向散射值；Sentinel-2图像包括13个波段，所有波段均为TOA反射率值。图像投影到WGS-84坐标系。不同波段的图像地面分辨率不同。为了融合图像，所有波段的地面分辨率采样为10米。

​		由于手动标签的成本较高，4370张图像没有手动标签。其余446张图像由训练有素的遥感分析员手工标注，用于高质量的模型培训、验证和测试。

​		4370张图像作为弱监督数据，包含两种类型的地表水标签。一种是基于Sentinel-1图像的直方图阈值法；另一种是基于Sentinel-2图像的归一化差分植被指数（NDVI）、MNDWI和阈值法生成的。所有云和云阴影像素都被遮罩，并从训练和精度评估中排除。手动标签包括水标签和永久水标签。

​		对于永久水标签，在JRC（欧盟委员会联合研究中心）地表水数据集的帮助下，Bonafilia等人[5]将数据集开始（1984年）和结束（2018年）检测为水的像素标记为永久水像素。在此期间从未观察到为水的像素被视为非水像素。其余像素被遮罩。

​		与大多数现有研究[42]一样，Sen1Floods11数据集显示了淹没区和未淹没区之间的高度不平衡分布。如表1所示，对于所有水，水像素仅占9.16%，非水像素占77.22%，大约是地表水像素数的八倍。永久水域中的水像素和非水像素的百分比为3.06%和96.64%。非水像素的数量大约是非水像素的32倍。

​		数据集分为三部分：训练集、验证集和测试集。所有4370张自动标记的图像被用作弱监督训练集。手动标记的数据首先以6:2:2的比例随机分为培训、验证和测试数据。

# 三、Method

采用空间分辨率重采样和像素值归一化方法对sentinel-1和sentinel-2图像进行融合。

模型输入是一组具有永久水和临时水注释的融合图像带。使用的网络是秦等人[43]提出的BASNet。BASNet体系结构如图5所示。该网络结合了一个类似于U-Net的密集监督编码器-解码器网络和一个新的残差细化模块。编码器-解码器根据图像输入生成粗略概率预测图，残差细化模块负责学习粗略概率预测图和地面真值之间的残差。我们将该网络应用于遥感数据集，对其进行调整、训练和优化，以更好地预测洪水区域。
